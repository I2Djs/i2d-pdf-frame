"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const p=require("i2djs"),d=require("vue"),x=["i-group","i-circle","i-line","i-path","i-ellipse","i-polygon","i-polyline","i-rect","i-text","i-image","i-page","i-linearGradient","i-radialGradient","i-page-template"];function C(r){const l={},u={},h={},{render:g}=d.createRenderer({patchProp(e,t,n,a,s,y,c,w,q){b(t)(e,a)},insert:(e,t,n)=>{!e||!t||!t.child||e instanceof p.CanvasGradient||t.child([e])},remove:e=>{e!=null&&e.remove()},createElement:(e,t,n,a)=>{const s=e.split("-").slice(1).join("-");let y=x.indexOf(e),c=null;switch(y===-1&&console.warn(`Unknown PDF-Frame tag: ${e}`),s){case"page-template":c=r.createTemplate(),u[a.id]=c;break;case"page":c=r.addPage();break;case"linearGradient":c=p.createLinearGradient(),h[a.id]=c;break;case"radialGradient":c=p.createRadialGradient(),h[a.id]=c;break;default:c=o(s);break}return c},createText:e=>{},createComment:e=>{},setText:(e,t)=>{},setElementText:(e,t)=>{},parentNode:e=>e&&e.dom.parent?e.dom.parent:null,nextSibling:e=>(t,n)=>{},querySelector:e=>r.fetchEl(e)||null}),b=e=>(t,n)=>{if(typeof n=="function"&&(n=n(t)),e!=="style")e==="src"&&!l[n]?(l[n]=r.createAsyncTexture({attr:{src:n}}),l[n].then(a=>{l[n]=a.exportAsDataUrl(),t.setAttr(e,l[n])})):e==="src"&&l[n]?t.setAttr(e,l[n]):e==="text"&&n?t.text(n):e==="p-template"&&t instanceof p.CanvasNodeExe?t.addTemplate(u[n]):t.setAttr(e,e==="transform"?i(n):n);else for(let a in n){let s=n[a];if((a==="fillStyle"||a==="strokeStyle")&&typeof s=="string"&&s.startsWith("grad")){const y=s.match(/\(([^)]+)\)/)[1];s=m(y)}t.setStyle(a,s)}};function o(e,t){return new p.CanvasNodeExe(r.ctx,{el:e,attr:{},style:{}},Math.round(Math.random()*1e7),0)}function i(e){if(typeof e=="object"&&!Array.isArray(e)&&e!==null)return e;const t={};for(const n in e=e.match(/(\w+\((\-?\d+\.?\d*e?\-?\d*,?)+\))+/g)){const a=e[n].match(/[\w\.\-]+/g);t[a.shift()]=a.map(s=>parseFloat(s))}return t}function m(e){return h[e]}return g}let f=null;const S=d.defineComponent({props:{type:{type:String,required:!0},id:{type:String,required:!0},height:{type:Number,required:!0},width:{type:Number,required:!0},layerSetting:{type:Object,required:!1,default:()=>{}},onUpdate:{type:Function,required:!1},config:{type:Object,required:!1,default:()=>{}},info:{type:Object,required:!1,default:()=>{}},encryption:{type:Object,required:!1,default:()=>{}}},setup(r,l){const u=d.getCurrentInstance();d.onMounted(()=>{const i=l.slots.default;f||(r.type==="pdf"||r.type==="pdf-blob"?f=g(r):r.type==="canvas"?f=b(r):console.warn(`Unknown render context: ${r.type}`));const m=C(f);d.nextTick().then(()=>{const e=d.h(h,i);m(e,f)})}),d.onUnmounted(()=>{f&&(f.destroy(),f=null)});const h=d.defineComponent({setup(i,m){const e=d.getCurrentInstance();e.parent=u,e.appContext=u.appContext,e.root=u.root,e.provides=u.provides;const t=m.slots.default;return()=>d.h(d.Fragment,t())}});function g(i){return p.pdfLayer(o.el,{height:i.height,width:i.width,...i.config||{},info:i.info||{},encryption:i.encryption||{}},{autoUpdate:!0,onUpdate:e=>{o.el.tagName==="IFRAME"&&o.el.setAttribute("src",e),i.onUpdate&&i.onUpdate(e)}})}function b(i){return p.canvasLayer(o.el,i.config,i.layerSetting)}let o;switch(r.type){case"pdf":o=d.h("iframe",{id:r.id,class:"pdfIframe renderOutput",type:"application/pdf",src:null,style:{height:"100%",width:"100%"}});break;case"pdf-blob":o=d.h("div",{id:r.id,class:"renderOutput"});break;case"canvas":o=d.h("div",{id:r.id,class:"renderOutput"});break;case"default":o=d.h("iframe",{id:r.id,class:"pdfIframe renderOutput",type:"application/pdf",src:null});break}return()=>o}});exports.default=S;
